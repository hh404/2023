class ViewController: UIViewController, UITextFieldDelegate {

    @IBOutlet weak var textField: UITextField!

    override func viewDidLoad() {
        super.viewDidLoad()
        textField.delegate = self
    }

    func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
        if let currentText = textField.text {
            // 获取新文本
            let newText = (currentText as NSString).replacingCharacters(in: range, with: string)
            
            // 大写前两个字符
            var modifiedText = newText.prefix(2).uppercased() + newText.dropFirst(2)
            
            // 在第五个字符后插入 '-'
            if modifiedText.count > 5 {
                let index = modifiedText.index(modifiedText.startIndex, offsetBy: 5)
                modifiedText.insert("-", at: index)
            }
            
            // 保存光标位置
            let cursorPosition = textField.position(from: textField.beginningOfDocument, offset: range.location + string.count)

            // 更新文本框内容
            textField.text = modifiedText

            // 恢复光标位置
            if let cursorPosition = cursorPosition {
                textField.selectedTextRange = textField.textRange(from: cursorPosition, to: cursorPosition)
            }

            return false  // 我们手动更新了文本内容
        }
        return true
    }
}